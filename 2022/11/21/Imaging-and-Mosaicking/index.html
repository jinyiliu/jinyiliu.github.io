<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Imaging and Mosaicking - Jinyi Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Jinyi Blog"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Jinyi Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Imaging Basics Mosaicking  每一次重温傅里叶变换都有新的认识！ An offset in one domain is a phase shift in the other. \(\color{black}F(x)\) and \(\color{black}\tilde{F}(k)\) are Fourier pairs then \[\color{black}F(x-x"><meta property="og:type" content="blog"><meta property="og:title" content="Imaging and Mosaicking"><meta property="og:url" content="https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/"><meta property="og:site_name" content="Jinyi Blog"><meta property="og:description" content="Imaging Basics Mosaicking  每一次重温傅里叶变换都有新的认识！ An offset in one domain is a phase shift in the other. \(\color{black}F(x)\) and \(\color{black}\tilde{F}(k)\) are Fourier pairs then \[\color{black}F(x-x"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/fourier_pairs.png"><meta property="og:image" content="https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/weighting_func.png"><meta property="article:published_time" content="2022-11-21T15:11:51.000Z"><meta property="article:modified_time" content="2023-04-07T11:48:27.626Z"><meta property="article:author" content="Jinyi"><meta property="article:tag" content="RadioAstro"><meta property="article:tag" content="SIW2022"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/fourier_pairs.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/"},"headline":"Imaging and Mosaicking","image":["https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/fourier_pairs.png","https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/weighting_func.png"],"datePublished":"2022-11-21T15:11:51.000Z","dateModified":"2023-04-07T11:48:27.626Z","author":{"@type":"Person","name":"Jinyi"},"publisher":{"@type":"Organization","name":"Jinyi Blog","logo":{"@type":"ImageObject","url":"https://jinyiliu.github.io/img/favicon.ico"}},"description":"Imaging Basics Mosaicking  每一次重温傅里叶变换都有新的认识！ An offset in one domain is a phase shift in the other. \\(\\color{black}F(x)\\) and \\(\\color{black}\\tilde{F}(k)\\) are Fourier pairs then \\[\\color{black}F(x-x"}</script><link rel="canonical" href="https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon.ico" alt="Jinyi Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-11-21T15:11:51.000Z" title="11/21/2022, 4:11:51 PM">2022-11-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-04-07T11:48:27.626Z" title="4/7/2023, 1:48:27 PM">2023-04-07</time></span></div></div><h1 class="title is-3 is-size-4-mobile">Imaging and Mosaicking</h1><div class="content"><ul>
<li><a target="_blank" rel="noopener" href="http://www.aoc.nrao.edu/events/synthesis/2022/slides/siw2022_imaging_wilner.pdf">Imaging Basics</a></li>
<li><a target="_blank" rel="noopener" href="http://www.aoc.nrao.edu/events/synthesis/2022/slides/bsmMosaicking2022.pdf">Mosaicking</a></li>
</ul>
<p>每一次重温傅里叶变换都有新的认识！</p>
<p>An offset in one domain is a phase shift in the other. \(\color{black}F(x)\) and \(\color{black}\tilde{F}(k)\) are Fourier pairs then</p>
<p>\[\color{black}F(x-x_0)&#x3D;\tilde{F}(k)e^{i2\pi x_0k}\]</p>
<p>换句话说，源的位置移动反应在傅里叶空间是一个相位的变化，也就是相位决定了位置。</p>
<span id="more"></span>

<p>If we have now the calibrated visibilities, we can analyze the visibilities directly by model fitting on condition that the source has simple structures. Or to choose to recover an image from incomplete, nosiy samples of visibilities.</p>
<h2 id="Imaging"><a href="#Imaging" class="headerlink" title="Imaging"></a><strong>Imaging</strong></h2><div style="text-align:center">
<img src="/2022/11/21/Imaging-and-Mosaicking/fourier_pairs.png" class="" width="500" alt="Fourier Transform of elliptical Gaussian">
</div>

<h3 id="Dirty-Beam-amp-Dirty-Images"><a href="#Dirty-Beam-amp-Dirty-Images" class="headerlink" title="Dirty Beam &amp; Dirty Images"></a><strong>Dirty Beam &amp; Dirty Images</strong></h3><p>Visibilities data \(\color{black}V(u,v)\) is actually sampled by</p>
<p>\[\color{black}S(u,v)&#x3D;\sum_{k&#x3D;1}^{M}\delta(u-u_k,v-v_k)\]</p>
<p>The direct Fourier transform of visibilities is a dirty image</p>
<p>\[\color{black}V(u,v)S(u,v)\rightarrow T^D(l,m)\]</p>
<p>\[\color{black}T(l,m)*s(l,m)&#x3D;T^D(l,m)\]</p>
<p>where the Fourier transform of the sampling pattern \(\color{black}s(l,m)\rightarrow S(u,v)\) is the <strong><font color="red">point spread function</font></strong> or the <strong><font color="red">synthesized beam</font></strong>. The dirty image is the true image convolved with the dirty beam.</p>
<h3 id="Gridding"><a href="#Gridding" class="headerlink" title="Gridding"></a><strong>Gridding</strong></h3><p>FFT is a must but it requires data on a regulary spaced grid. Conventional approach is to use convolution:</p>
<p>\[\color{black}V^G(u,v) &#x3D; V(u,v)S(u,v) * G(u,v) \rightarrow T^D(l,m)g(l,m)\]</p>
<p>Now we can get our dirty image pretty fast.</p>
<h3 id="Weighting"><a href="#Weighting" class="headerlink" title="Weighting"></a><strong>Weighting</strong></h3><p>Introduce weighting function \(\color{black}W(u,v)\) into the gridding process, this modifies the sampling function as \(\color{black}S(u,v)W(u,v)\) and changes the dirty beam shape \(\color{black}s(l,m)\). CASA uses <strong>Robust (Briggs) weighting</strong> that can usually obtain most of the natural weight sensitivity at the same time as most of uniform weight resolution.</p>
<div style="text-align:center">
<img src="/2022/11/21/Imaging-and-Mosaicking/weighting_func.png" class="" alt="Example dirty beams (ALMA)">
</div>

<p>The above sections will provide us dirty beam and dirty images. The next step is to clean the dirty images.</p>
<h3 id="Deconvolution"><a href="#Deconvolution" class="headerlink" title="Deconvolution"></a><strong>Deconvolution</strong></h3><p>Use non-linear techniques to interpolate&#x2F;extrapolate \(\color{black}v(u,v)\) samples into unsampled regions of \(\color{black}(u,v)\) plane to find a plausible model of \(\color{black}T(l,m)\). A prior assumption about \(\color{black}T(l,m)\) is that it can be represented by point sources.</p>
<p>The dominant deconvolution algorithm in radio astronomy is <strong><font color="red">CLEAN</font></strong>.</p>
<h3 id="Classic-Hogbom-CLEAN-algorithm"><a href="#Classic-Hogbom-CLEAN-algorithm" class="headerlink" title="Classic Hogbom CLEAN algorithm"></a><strong>Classic Hogbom CLEAN algorithm</strong></h3><p>See Video Lecture 51:40 which has a vivid illustration.</p>
<h2 id="Mosaicking"><a href="#Mosaicking" class="headerlink" title="Mosaicking"></a><strong>Mosaicking</strong></h2><p>Pass.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Imaging and Mosaicking</p><p><a href="https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/">https://jinyiliu.github.io/2022/11/21/Imaging-and-Mosaicking/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Jinyi</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-11-21</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-04-07</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/RadioAstro/">RadioAstro</a><a class="link-muted mr-2" rel="tag" href="/tags/SIW2022/">SIW2022</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/jinyiliu" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/12/09/VLA-Continuum-Tutorial-3C391/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">VLA Continuum Tutorial 3C391</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/11/12/Calibration-in-Radio/"><span class="level-item">Calibration in Radio</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.jpg" alt="刘晋弋"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">刘晋弋</p><p class="is-size-6 is-block">Master in Astrophysics</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Leiden, Nederland</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">25</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">13</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/jinyiliu"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AST9240/"><span class="tag">AST9240</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CMB/"><span class="tag">CMB</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Life/"><span class="tag">Life</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Physics/"><span class="tag">Physics</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RadioAstro/"><span class="tag">RadioAstro</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SIW2022/"><span class="tag">SIW2022</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WeakLensing/"><span class="tag">WeakLensing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bnu/"><span class="tag">bnu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mac/"><span class="tag">mac</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/math/"><span class="tag">math</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vim/"><span class="tag">vim</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Imaging"><span class="level-left"><span class="level-item">1</span><span class="level-item">Imaging</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Dirty-Beam-amp-Dirty-Images"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Dirty Beam &amp; Dirty Images</span></span></a></li><li><a class="level is-mobile" href="#Gridding"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Gridding</span></span></a></li><li><a class="level is-mobile" href="#Weighting"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">Weighting</span></span></a></li><li><a class="level is-mobile" href="#Deconvolution"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Deconvolution</span></span></a></li><li><a class="level is-mobile" href="#Classic-Hogbom-CLEAN-algorithm"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">Classic Hogbom CLEAN algorithm</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Mosaicking"><span class="level-left"><span class="level-item">2</span><span class="level-item">Mosaicking</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon.ico" alt="Jinyi Blog" height="28"></a><p class="is-size-7"><span>&copy; 2024 Jinyi</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>